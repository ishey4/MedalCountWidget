"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c};MedalCountWidget=function(){"use strict";function c(p,q){if(!(p instanceof q))throw new TypeError("Cannot call a class as a function")}function d(p,q){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return q&&("object"===("undefined"==typeof q?"undefined":_typeof(q))||"function"==typeof q)?q:p}function f(p,q){if("function"!=typeof q&&null!==q)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof q?"undefined":_typeof(q)));p.prototype=Object.create(q&&q.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),q&&(Object.setPrototypeOf?Object.setPrototypeOf(p,q):p.__proto__=q)}function g(p,q,r){var s;"js"==q?(s=document.createElement("script"),s.setAttribute("type","text/javascript"),s.setAttribute("src",p)):"css"==q&&(s=document.createElement("link"),s.setAttribute("rel","stylesheet"),s.setAttribute("type","text/css"),s.setAttribute("href",p));s.readyState?s.onreadystatechange=function(){("loaded"===s.readyState||"complete"===s.readyState)&&(script.onreadystatechange=null,r())}:s.onload=function(){r()};"undefined"!=typeof s&&document.getElementsByTagName("head")[0].appendChild(s)}function h(p,q){var r=document.getElementById(p);return(q=q||{},q.ReactDOMUrl=q.ReactDOMUrl||"https://unpkg.com/react-dom@16/umd/react-dom.production.min.js",q.ReactUrl=q.ReactUrl||"https://unpkg.com/react@16/umd/react.production.min.js",q.parentContainer=q.parentContainer||r,g("https://ishey4.github.io/widgetStyles.css","css",function(){}),"undefined"==typeof React)?(g(q.ReactUrl,"js",function(){return function(){h(p,q)}}(p,q)),void 0):"undefined"==typeof ReactDOM?(g(q.ReactDOMUrl,"js",function(){return function(){h(p,q)}}(p,q)),void 0):void j(q)}function j(p){if("undefined"!=typeof window.ReactDOM&&"undefined"!=typeof window.React){var q=React.createElement(l(React.Component),p);ReactDOM.render(q,p.parentContainer)}}var k=function(){function p(q,r){for(var t,s=0;s<r.length;s++)t=r[s],t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(q,t.key,t)}return function(q,r,s){return r&&p(q.prototype,r),s&&p(q,s),q}}(),l=function MedalCountWidget(p){function q(r){c(this,q);var s=d(this,(q.__proto__||Object.getPrototypeOf(q)).call(this,r));return s.state={medals:[],maxRows:r.maxRows||10,loadingError:!1,parentContainer:r.parentContainer,parentWidth:r.parentContainer.offsetWidth,sort:{sortField:r.initialSortField||"gold",sortDirection:r.initialSortDirection&&-1*r.initialSortDirection||1}},s}return f(q,p),k(q,[{key:"componentDidMount",value:function(){var s=this;this.getMedals();this.header=["rank","flag","code","spacer","gold","silver","bronze","total"].map(function(u){return m(u,s.updateSortOrder.bind(s))})}},{key:"getMedals",value:function(){var s=new XMLHttpRequest,t=this;s.onreadystatechange=function(){var v=!1,w=[];if(4===this.readyState&&200!==this.status&&(v=!0),4===this.readyState&&200===this.status){var x=JSON.parse(this.response);x.sort(t.sortMedalsBy("code",-1));var y=t.getCounter();x.forEach(function(z){z.total=z.gold+z.silver+z.bronze,z.key=y()}),w=x}t.setState({loadingError:v,medals:w})},s.open("GET","https://s3-us-west-2.amazonaws.com/reuters.medals-widget/medals.json",!0),s.send()}},{key:"setWidgetWidth",value:function(s){var t=["width1","width2","width3"];return 160<s&&t.pop(),200<s&&t.pop(),(210<s&&t.pop(),t)}},{key:"getCounter",value:function(){var s=-1;return function(){return++s,s}}},{key:"sortMedalsBy",value:function(s,t){var u=t;return function(v,w){return v[s]>w[s]?-1*u:v[s]<w[s]?1*u:v.gold>w.gold?-1*u:v.gold<w.gold?1*u:v.silver>w.silver?-1*u:v.silver<w.silver?1*u:v.bronze>w.bronze?-1*u:v.bronze<w.bronze?1*u:0}}},{key:"updateSortOrder",value:function(s){var t=1;this.state.sort.sortField===s&&(t=-1*this.state.sort.sortDirection),this.setState({sort:{sortField:s,sortDirection:t}})}},{key:"render",value:function(){var s=this,t=this.sortMedalsBy(this.state.sort.sortField,this.state.sort.sortDirection),u=this.setWidgetWidth(this.state.parentWidth);return u.push("MedalCountWidget"),React.createElement("div",{className:u.join(" ")},React.createElement("div",{className:this.state.loadingError?"":"DisplayNone"},React.createElement(n,null)),React.createElement("div",{className:"TableDisplay "+(this.state.loadingError?"DisplayNone":"")},React.createElement("div",null," Medal Count "),React.createElement("table",{selectedrow:this.state.sort.sortField,sortdirection:this.state.sort.sortDirection.toString()},React.createElement("tbody",null,React.createElement("tr",null,this.header),this.state.medals.sort(t).slice(0,this.state.maxRows).map(function(v){return o(v)})))))}}]),q},m=function(q,r){return React.createElement("th",{key:q,className:q,onClick:function(){r(q)}},React.createElement("div",{className:"MedalCircle"}))},n=function(){return React.createElement("div",{className:"ErrorDiv"},"Error Loading Widget!")},o=function(q){var r={backgroundPositionY:(-17*q.key).toString()+"px"};return React.createElement("tr",{key:q.key},React.createElement("td",{className:"Rank"}),React.createElement("td",null,React.createElement("span",{style:r,className:"FlagBackground"})),React.createElement("td",{className:"MedalCode"},q.code),React.createElement("td",{className:"Spacer"}),React.createElement("td",null,q.gold),React.createElement("td",null,q.silver),React.createElement("td",null,q.bronze),React.createElement("td",{className:"totalColumn"},q.total))};return{initialize:h}}();
